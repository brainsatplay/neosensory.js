!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.neosensory=n():e.neosensory=n()}(this,(function(){return(()=>{"use strict";var e={d:(n,t)=>{for(var o in t)e.o(t,o)&&!e.o(n,o)&&Object.defineProperty(n,o,{enumerable:!0,get:t[o]})},o:(e,n)=>Object.prototype.hasOwnProperty.call(e,n),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},n={};function t(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return o(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?o(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function i(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}e.r(n),e.d(n,{Buzz:()=>a});var a=function(){function e(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};r(this,e),this.interface=null,this.readBuffer=[],this.lastCommand=[],this.interface=new c;var a=this.interface.onConnectedCallback;this.interface.onConnectedCallback=function(){a(),o()};var s=this.interface.onDisconnectedCallback;this.interface.onDisconnectedCallback=function(){s(),i()},this.interface.onNotificationCallback=function(e){t(n.parseResponse(n.interface.decoder.decode(e.target.value)))}}var n,o;return n=e,(o=[{key:"sendCommand",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.interface.sendMessage(e)}},{key:"requestAuthorization",value:function(){this.sendCommand("auth as developer\n")}},{key:"acceptTerms",value:function(){this.sendCommand("accept\n")}},{key:"pauseDeviceAlgorithm",value:function(){this.audio.stop(),this.motors.start()}},{key:"resumeDeviceAlgorithm",value:function(){this.audio.start()}},{key:"battery",value:function(){this.sendCommand("device battery_soc\n")}},{key:"info",value:function(){this.sendCommand("device info\n")}},{key:"connect",value:function(){var e=this;this.interface.connect(),this.audio={start:function(){e.sendCommand("audio start\n")},stop:function(){e.sendCommand("audio stop\n")}},this.motors={clear:function(){e.sendCommand("motors clear_queue\n")},start:function(){e.sendCommand("motors start\n")},stop:function(){e.sendCommand("motors stop\n")},vibrate:function(n){var o=btoa(String.fromCharCode.apply(String,t(new Uint8Array(n.flat()))));e.sendCommand("motors vibrate ".concat(o,"\n"))},threshold:{set:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";"default"==n&&(n=0),"always"==n&&(n=1),"threshold"==n&&(n=2),e.sendCommand("motors config_threshold ".concat(n," ").concat(t,"\n"))},get:function(){e.sendCommand("motors get_threshold\n")}},configThreshold:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";"default"==n&&(n=0),"always"==n&&(n=1),"threshold"==n&&(n=2),e.sendCommand("motors config_threshold ".concat(n," ").concat(t,"\n"))},lra:{set:function(n){"open"==n&&(n=0),"closed"==n&&(n=1),e.sendCommand("motors config_lra_mode ".concat(n,"\n"))},get:function(){e.sendCommand("motors get_lra_mode ".concat(mode,"\n"))}}},this.leds={get:function(){e.sendCommand("leds get\n")},set:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=function(e,n,t){return"0x"+((1<<24)+(e<<16)+(n<<8)+t).toString(16).slice(1)};n=n.map((function(e){return r.apply(void 0,t(e))})),e.sendCommand("leds set ".concat(n.join(" ")," ").concat(o.map((function(e){return 50*e})).join(" "),"\n"))}},this.button={set:function(n,t){1!=n&&"true"!=n||(n=1),0!=n&&"false"!=n||(n=0),1!=t&&"true"!=t||(t=1),0!=t&&"false"!=t||(t=0),e.sendCommand("set_buttons_response ".concat(n," ").concat(t,"\n"))}}}},{key:"parseResponse",value:function(e){var n=!1;if(-1!=e.indexOf("{")&&0==this.readBuffer.length?-1!=e.lastIndexOf("}")?(this.lastCommand=e.slice(0,e.indexOf("{")),this.readBuffer.push(e.substring(e.indexOf("{"),e.lastIndexOf("}")+1)),n=!0):this.readBuffer.push(e.substring(e.indexOf("{"))):-1!=e.lastIndexOf("}")?(this.readBuffer.push(e.substring(0,e.lastIndexOf("}")+1)),n=!0):0!=this.readBuffer.length&&this.readBuffer.push(e),n){var t=this.readBuffer.join("");return this.readBuffer=[],(e=JSON.parse(t)).command=this.lastCommand,this.readBuffer=[],e}}},{key:"disconnect",value:function(){this.interface.disconnect(),delete this.audio,delete this.motors,delete this.leds}}])&&i(n.prototype,o),e}(),c=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"6e400001-b5a3-f393-e0a9-e50e24dcca9e",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"6e400002-b5a3-f393-e0a9-e50e24dcca9e",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"6e400003-b5a3-f393-e0a9-e50e24dcca9e";r(this,e),s.call(this),this.serviceUUID=n,this.rxUUID=t,this.txUUID=o,this.encoder=new TextEncoder("utf-8"),this.decoder=new TextDecoder("utf-8"),this.device=null,this.server=null,this.service=null,this.rxchar=null,this.txchar=null,this.android=navigator.userAgent.toLowerCase().indexOf("android")>-1,this.n},s=function(){var e=this;this.connect=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.serviceUUID,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.rxUUID,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.txUUID;function r(e){return function(n){return new Promise((function(t){return setTimeout((function(){return t(n)}),e)}))}}navigator.bluetooth.requestDevice({filters:[{services:[n]},{namePrefix:"Buzz"}],optionalServices:[n]}).then((function(n){return e.device=n,n.gatt.connect()})).then(r(100)).then((function(e){return e.getPrimaryService(n)})).then(r(100)).then((function(n){return e.service=n,n.getCharacteristic(t).then(r(100)).then((function(n){return e.rxchar=n,!0})),n.getCharacteristic(o)})).then(r(1100)).then((function(n){return e.txchar=n,e.txchar.startNotifications().then((function(){e.txchar.addEventListener("characteristicvaluechanged",e.onNotificationCallback)}))})).then(r(100)).then(e.onConnectedCallback()).catch((function(n){console.error(n),e.onErrorCallback(n)}))},this.onNotificationCallback=function(e){},this.onConnectedCallback=function(){},this.sendMessage=function(n){"\n"!=n[n.length-2]&&(n+="\n");var t=e.encoder.encode(n);e.rxchar.writeValue(t)},this.disconnect=function(){var n;null===(n=e.server)||void 0===n||n.disconnect(),e.onDisconnectedCallback()},this.onDisconnectedCallback=function(){}};return n})()}));